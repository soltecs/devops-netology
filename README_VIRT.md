# Введение в виртуализацию

1. Опишите кратко, в чём основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

* Аппаратная виртуализация - создание множество изолированных виртуальных систем на одном оборудовании. Устройства виртуальной машины полностью эмулируют работу оборудования, вплоть до регистров, памяти и т.д. В этом случае внутренняя программа практически не подозравает о какой-то подмене.
При аппаратной виртуализации гостевая операционная система не обязательно должна совпадать с ОС-гипервизором. 
* Паравиртуализация, тоже самое, что и в предыдущем случае, но некоторые компоненты, например, сетевые, дисковые устройства могут быть доступны напрямую через вызовы виртуальной машины. 
Паравиртуализация в общем случае работает быстрее, так как нет накладных расходов на ненужную эмуляцию. Требование программной виртуализации: гостевая ОС должна быть одинакова с хост-системой.
* Виртуализация на уровне ОС позволяет виртуализовывать физические серверы на уровне ядра операционной системы.

2. Выберите один из вариантов использования организации физических серверов в зависимости от условий использования.

* виртуализация уровня ОС 
> различные web-приложения;

> Windows-системы для использования бухгалтерским отделом;

Нет требований к высокой нагрузки и отказоустойчивости.
Решение будет оптимальным в соотношении цены / качества.

* паравиртуализация
> системы, выполняющие высокопроизводительные расчёты на GPU.

Здесь есть требования к производительности.
Паравиртуализация не тратит ресурсы на эмуляцию, а соответственно будет работать быстрее.

* физические сервера
> высоконагруженная база данных, чувствительная к отказу;

Аптайм системы и высокая нагрузка, здесь подходит аппаратная виртуализация.

3. Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

> 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based-инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.

Можно поставить VMWare, поддерживает и Linux и Windows. 

> Требуется наиболее производительное бесплатное open source-решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.

KVM или XEN

> Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows-инфраструктуры.

Можно поставитьь Hyper-V.

> Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

Docker или OpenVZ


4. >Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

Разнородность директорий хранения данных и произвольное расположение виртуальных машин в инфраструктуре значительно усложняет задачу управления огромными объемами динамических данных.
Для гибридной среды нужны гибридные решения – необходимо использовать комплексные решения, которые смогут функционировать как в физической, так и в виртуальной среде.

# Применение принципов IaaC в работе с виртуальными машинами

1. Опишите основные преимущества применения на практике IaaC-паттернов.
>Опишите основные преимущества применения на практике IaaC-паттернов.
- Ускорение производства и вывода продукта на рынок
- Стабильность среды, устранение дрейфа конфигураций
- Более быстрая и эффективная разработка
> Какой из принципов IaaC является основополагающим?
- Идемпонентность - свойство объекта или операции, при повторном выполнении которой мы получаем результат идентичный предыдущему и всем последующим операциям

2. >Чем Ansible выгодно отличается от других систем управление конфигурациями?
- Низкий порог входа, отсутствие необходимости установки агентов на целевые хосты для управления
>Какой, на ваш взгляд, метод работы систем конфигурации более надёжный — push или pull?
- push

3. >Приложите вывод команд установленных версий каждой из программ, оформленный в Markdown. 
- Vagrant
```bash
yurykov@yurykov:~/Downloads$ vagrant --version
Vagrant 2.3.7
```
- Terraform
```bash
yurykov@yurykov:~/Downloads$ terraform --version
Terraform v1.5.3
on linux_amd64
```
- Virtualbox
```bash
yurykov@yurykov:~/Downloads$ vboxmanage --version
7.0.10r158379
```
- Ansible
```bash
yurykov@yurykov:~/Downloads$ ansible --version
ansible [core 2.14.6]
  config file = /etc/ansible/ansible.cfg
  configured module search path = ['/home/yurykov/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3/dist-packages/ansible
  ansible collection location = /home/yurykov/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible
  python version = 3.10.6 (main, May 29 2023, 11:10:38) [GCC 11.3.0] (/usr/bin/python3)
  jinja version = 3.0.3
  libyaml = True
```

# Введение. Экосистема. Архитектура. Жизненный цикл Docker-контейнера

1. Задача №1
- Команда на скачивание:
```
docker pull yurykov/devops-netology:0.1
```
- Команда на запуск:
```
docker run -it --rm -d -p 8080:80 --name web yurykov/devops-netology:0.1
```
2. Задача №2

> Посмотрите на сценарий ниже и ответьте на вопрос: «Подходит ли в этом сценарии использование Docker-контейнеров или лучше подойдёт виртуальная машина, физическая машина? Может быть, возможны разные варианты?»
> Детально опишите и обоснуйте свой выбор.

>высоконагруженное монолитное Java веб-приложение;

Лучше использовать физический сервер:
- Требования к нагрузке
- Монолит != микросервисы

>Nodejs веб-приложение;

Достаточно докера

>мобильное приложение c версиями для Android и iOS;

Виртуализация, нужен UI

>шина данных на базе Apache Kafka;

Можно использовать Docker

>Elasticsearch-кластер для реализации логирования продуктивного веб-приложения — три ноды elasticsearch, два logstash и две ноды kibana;

ES на VM, Kibana и Logstash на докеры

>мониторинг-стек на базе Prometheus и Grafana;

Только чтение, докер идеален 

>MongoDB как основное хранилище данных для Java-приложения;

При большой нагрузке лучше VM

>Gitlab-сервер для реализации CI/CD-процессов и приватный (закрытый) Docker Registry.

VM и Docker

3. Задача №3

>Запустите первый контейнер из образа centos c любым тегом в фоновом режиме, подключив папку /data из текущей рабочей директории на хостовой машине в /data контейнера.
>Запустите второй контейнер из образа debian в фоновом режиме, подключив папку /data из текущей рабочей директории на хостовой машине в /data контейнера.
>Подключитесь к первому контейнеру с помощью docker exec и создайте текстовый файл любого содержания в /data.
>Добавьте ещё один файл в папку /data на хостовой машине.
>Подключитесь во второй контейнер и отобразите листинг и содержание файлов в /data контейнера.

```
$ docker exec -it debian bash
root@e97dc5579887:/data# ls -la
total 16
drwxrwxr-x 2 root root 4096 Jul 23 17:26 .
drwxr-xr-x 1 root root 4096 Jul 23 17:23 ..
-rw-r--r-- 1 root root    7 Jul 23 17:25 centos.txt
-rw-rw-r-- 1 root root    5 Jul 23 17:26 host.txt
```

4. Задача 4 (*)

```
docker pull yurykov/ansible:0.1
```